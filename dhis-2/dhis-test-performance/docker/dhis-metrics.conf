# DHIS2 configuration with metrics enabled
#
# Usage:
#   DHIS_CONF_FILE=dhis-metrics.conf docker compose --profile monitoring up

connection.dialect = org.hibernate.dialect.PostgreSQLDialect
connection.driver_class = org.postgresql.Driver
connection.url = jdbc:postgresql://db/dhis
connection.username = dhis
connection.password = dhis

flyway.migrate_out_of_order=true
flyway.repair_before_migration=true

# Explicitly set HikariCP (required for versions < 2.43 which defaulted to C3P0)
db.pool.type = hikari

# Uncomment and use large pool to demonstrate linear connection scaling without blocking. Each
# concurrent request holds ~2 connections (HTTP thread + async overlap)
# connection.pool.max_size = 500
connection.pool.max_size = 80

system.update_notifications_enabled = off

tracker.import.preheat.cache.enabled = off

# Enable monitoring metrics for performance analysis
monitoring.api.enabled = on
monitoring.cpu.enabled = on
monitoring.jvm.enabled = on
monitoring.uptime.enabled = on
monitoring.dbpool.enabled = on
monitoring.hibernate.enabled = off
monitoring.ehcache.enabled = off
