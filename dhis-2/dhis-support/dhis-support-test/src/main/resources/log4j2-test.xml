<?xml version="1.0" encoding="UTF-8"?>
<!-- NOTE: configuration changes will only have an effect AFTER recompiling dhis-support-test
     If you find a way for us to only re-run the test to see config changes without having to recompile
     dhis-support-test , please do :) -->
<Configuration status="warn">
    <Properties>
        <Property name="layout">%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n</Property>
        <!-- CI sets TEST_LOG_SUPPRESSED_LEVEL=error when ci-verbose label is present to show all errors.
        Defaults to off which disables these loggers entirely. -->
        <Property name="suppressed.level">${env:TEST_LOG_SUPPRESSED_LEVEL:-off}</Property>
    </Properties>

    <Appenders>
        <Console name="console" target="SYSTEM_OUT">
            <PatternLayout pattern="${layout}"/>
        </Console>
        <File name="file" fileName="target/test.log">
            <PatternLayout pattern="${layout}"/>
        </File>
    </Appenders>

    <Loggers>
        <!-- Suppress expected errors from tests exercising error paths and from resources
        not available in test classpaths (e.g. build.properties, apps-bundle.json).
        These are not real failures - the tests pass, but the application logs at ERROR. -->
        <Logger name="org.hisp.dhis.scheduling" level="${suppressed.level}"/>
        <Logger name="org.hisp.dhis.system" level="${suppressed.level}"/>
        <Logger name="org.hisp.dhis.appmanager" level="${suppressed.level}"/>
        <Logger name="org.hisp.dhis.fileresource" level="${suppressed.level}"/>
        <Logger name="org.hisp.dhis.sms" level="${suppressed.level}"/>
        <Logger name="org.hisp.dhis.route" level="${suppressed.level}"/>
        <Logger name="org.hisp.dhis.dxf2.gml" level="${suppressed.level}"/>
        <Logger name="org.hisp.dhis.rules.engine" level="${suppressed.level}"/>
        <Logger name="org.hisp.dhis.tracker.imports.sms" level="${suppressed.level}"/>
        <Logger name="org.hisp.dhis.webapi.controller" level="${suppressed.level}"/>

        <Root level="warn">
            <!-- Set to error so CI test runs are quiet, we see failed tests easily but still see errors from libraries
            we use due to for example misconfigurations or so. If you want to increase the verbosity of specific
            packages use a logger like shown below. -->
            <AppenderRef ref="console" level="error"/>
            <!-- Used to upload test logs during CI in case a test step fails. Verbosity is a bit higher, so we have more
             information when debugging failed tests. -->
            <AppenderRef ref="file" level="warn"/>
        </Root>

        <!-- A few examples of loggers that might be useful to debug integration test issues.
        Adding an AppenderRef is necessary to overrule the log level we have set on the Root AppenderRefs.
        Once you add an AppenderRef to a Logger you need to set additivity to false otherwise logs might appear twice
        as they propagate up from the Logger to its parent which is the Root.
        Check the log4j2 config documentation for more details. -->
        <!-- Uncomment if you want to debug DHIS2 -->
        <!-- <Logger name="org.hisp.dhis" level="debug" additivity="false">-->
        <!--     <AppenderRef ref="console"/>-->
        <!-- </Logger>-->
        <!-- Uncomment if you want to debug testcontainers -->
        <!-- <Logger name="org.testcontainers" level="debug" additivity="false">-->
        <!--     <appenderref ref="console"/>-->
        <!-- </Logger>-->
        <!-- <Logger name="com.github.dockerjava" level="all" additivity="false">-->
        <!--     <AppenderRef ref="console"/>-->
        <!-- </Logger>-->
        <!-- Uncomment if you want to debug spring test context (cache) -->
        <!-- <Logger name="org.springframework.test.context.cache" level="debug">-->
        <!--     <AppenderRef ref="console"/>-->
        <!-- </Logger>-->
        <!-- Uncomment to debug Spring bean creation/test configuration -->
        <!--<Logger name="org.springframework.beans.factory.support.DefaultListableBeanFactory" level="debug" additivity="false">
                <AppenderRef ref="console"/>
        </Logger>-->
    </Loggers>
</Configuration>
