# Scheduled performance tests - runs a matrix of tests on a schedule
name: Performance tests scheduled
run-name: Performance tests scheduled

on:
  workflow_dispatch:
  push:
    branches:
      - DHIS2-20288
    paths:
      - '.github/workflows/performance-tests-scheduled.yml'
  schedule:
    # Run at 1 AM UTC every day
    - cron: "0 1 * * *"

jobs:
  run-scheduled-tests:
    strategy:
      fail-fast: false
      matrix:
        include:
          # Team Tracker Backend Tests
          - name: tracker
            env: |
              DHIS2_IMAGE=dhis2/core-dev:latest
              SIMULATION_CLASS=org.hisp.dhis.test.tracker.TrackerTest
              WARMUP=0
            slack_webhook_secret: SLACK_WEBHOOK_TRACKER_BACKEND
    uses: ./.github/workflows/performance-tests.yml
    with:
      perf_tests_git_ref: master
      test_env: ${{ matrix.env }}
      test_name: ${{ matrix.name }}
    secrets:
      slack_webhook: ${{ secrets[matrix.slack_webhook_secret] }}
